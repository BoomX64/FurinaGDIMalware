import win32gui
import win32api
import win32con 
import ctypes
import random
import math
import time
import tkinter as tk


class main_application():
  def __init__(self):
    super().__init__()

    self.change_backgroud()
    time.sleep(2)
    
    self.playload_01()
    time.sleep(30)
    
    self.playload_02()
    time.sleep(30)

def change_background(self):
  background_path = "path"
  ctypes.windll.user32.systemParameterInfoW(20, 0, background_path, 0)

def playload_01(self):
  user32 = ctypes.windll.user32
  user32.SetProcessDPIAware()
  [sw, sh] = [user32.GetSystemMetrics(0), user32.GetSystemMetrics(1)] 
  hdc = win32gui.GetDC(0)

  while True:
    win32gui.BitBlt(hdc, 0, 0, sw, sh, hdc, -3,-3, win32con.NOTSRCCOPY)

def playload_02(self):
  hdc = win32gui.GetDC(0)
  user32 = ctypes.windll.user32
  user32.SetProcessDPIAware()
  [w, h] = [user32.GetSystemMetrics(0), user32.GetSystemMetrics(1)]

  x = y = 0
  while True:
      win32gui.DrawIcon(hdc, x , y , win32gui.LoadIcon(None, win32con.IDI_ERROR)) # Change IDI_ERROR to something else to change the icon being displayed
      x = x + 30
      if x >= w:
        y = y + 30
        x = 0
      if y >= h:
        x = y = 0


application = main_application()
